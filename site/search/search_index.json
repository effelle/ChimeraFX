{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to ChimeraFX","text":"<p>ChimeraFX is a native C++ custom component for ESPHome that brings the beauty of WLED effects to your Home Assistant setup, without the complexity.</p> <p>It allows you to run genuine WLED effects (like Pacifica, Aurora, Plasma, and Fire 2012) with high performance on ESP32 devices, completely avoiding the overhead and \"spaghetti code\" of old YAML lambda implementations.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Native Performance: Optimized for ESP-IDF and dual-core ESP32s.</li> <li>Zero-Lambda Config: Uses a clean <code>external_components</code> setup.</li> <li>Rich Effect Library: Ports of complex effects that were previously impossible or slow in pure YAML.</li> <li>Full Control: Support for Speed, Intensity, Palettes, and Mirroring.</li> <li>Custom Palettes: Use built-in WLED palettes or define your own.</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>Installation Guide - Get up and running in minutes.</li> <li>Configuration Guide - How to set up inputs and switches.</li> <li>Effect Library - Browse available effects and palettes.</li> <li>Troubleshooting - Fix common issues (flickering, memory).</li> </ul> <p>Built with \u2764\ufe0f by Federico Leoni</p>"},{"location":"Configuration/","title":"YAML Configuration Guide","text":"<p>Unlike WLED, where everything is pre-configured, ESPHome requires you to define your inputs (sliders, dropdowns) explicitly. This gives you the power to create multiple independent light setups or simplify controls as you see fit.</p>"},{"location":"Configuration/#the-controller-logic","title":"The Controller Logic","text":"<p>The <code>addressable_cfx</code> effect listens to specific global variables (numbers/selects) to adjust its behavior in real-time.</p> <p>Two Ways to Configure: 1.  Automatic (Recommended): Use the <code>cfx_control</code> component (see Quick Start). It generates all necessary entities for you using core <code>number</code>, <code>select</code>, and <code>switch</code> components.</p> <pre><code>**Generated Controls:**\n- `{id}_speed` (Number)\n- `{id}_intensity` (Number)\n- `{id}_palette` (Select)\n- `{id}_mirror` (Switch)\n- `{id}_intro` (Select)\n- `{id}_intro_dur` (Number)\n- `{id}_timer` (Number)\n\n**Exclusion Options:**\nValid IDs for `exclude: [...]`:\n\n| ID | Control |\n|:---|:---|\n| `1` | Speed |\n| `2` | Intensity |\n| `3` | Palette |\n| `4` | Mirror |\n| `5` | Intro Effects (Intro &amp; Duration) |\n| `6` | Timer |\n</code></pre> <ol> <li>Manual: Define each entity yourself using template components. This gives you full control over IDs and naming but requires more YAML.</li> </ol>"},{"location":"Configuration/#required-entities-manual-method","title":"Required Entities (Manual Method)","text":"<p>If you are NOT using <code>cfx_control</code>, you MUST manually define the following entities in your YAML and link them to the effect.</p> <p>To get the full WLED experience, you need to define the following in your YAML.</p>"},{"location":"Configuration/#1-the-light-component","title":"1. The Light Component","text":"<p>We strongly recommend <code>esp32_rmt_led_strip</code> for the best timing on ESP32/S3.</p> <pre><code>light:\n  - platform: esp32_rmt_led_strip\n    rgb_order: GRB\n    pin: GPIO16\n    num_leds: 60\n    rmt_channel: 0\n    chipset: ws2812\n    name: \"My WLED Strip\"\n    id: led_strip\n\n    effects:\n      - addressable_cfx:\n          name: \"Aurora\"\n          effect_id: 38\n          # Link the effect to your controls (optional)\n          speed: cfx_speed\n          intensity: cfx_intensity\n          palette: cfx_palette\n          intensity: cfx_intensity\n          palette: cfx_palette\n          mirror: cfx_mirror\n</code></pre>"},{"location":"Configuration/#2-control-entities","title":"2. Control Entities","text":"<p>Copy-paste this block into your YAML to create the controls in Home Assistant.</p> <pre><code># 1. Slider for Speed\nnumber:\n  - platform: template\n    id: cfx_speed\n    name: \"Effect Speed\"\n    min_value: 0\n    max_value: 255\n    initial_value: 128\n    step: 1\n    optimistic: true\n\n# 2. Slider for Intensity\n  - platform: template\n    id: cfx_intensity\n    name: \"Effect Intensity\"\n    min_value: 0\n    max_value: 255\n    initial_value: 128\n    step: 1\n    optimistic: true\n\n# 3. Dropdown for Palettes\nselect:\n  - platform: template\n    id: cfx_palette\n    name: \"Effect Palette\"\n    options: [\"Default\", \"Forest\", \"Ocean\", \"Rainbow\", \"Fire\", \"Sunset\", \"Ice\", \"Party\", \"Lava\", \"Pastel\", \"Pacifica\", \"HeatColors\", \"Sakura\", \"Rivendell\", \"Cyberpunk\", \"OrangeTeal\", \"Christmas\", \"RedBlue\", \"Matrix\", \"SunnyGold\", \"None\"]\n    initial_option: \"Default\"\n    optimistic: true\n\n# 4. Switch for Direction\nswitch:\n  - platform: template\n    id: cfx_mirror\n    name: \"Effect Mirror\"\n    optimistic: true\n\n# 5. Intro Controls (Boot Animation)\nselect:\n  - platform: template\n    id: cfx_intro\n    name: \"Intro Effect\"\n    options: [\"None\", \"Wipe\", \"Fade\", \"Center\", \"Glitter\"]\n    initial_option: \"Wipe\"\n    optimistic: true\n\nnumber:\n  - platform: template\n    id: cfx_intro_dur\n    name: \"Intro Duration (s)\"\n    min_value: 0.5\n    max_value: 10.0\n    step: 0.1\n    initial_value: 3.0\n    optimistic: true\n</code></pre>"},{"location":"Configuration/#intro-turn-on-effects","title":"Intro &amp; Turn-On Effects","text":"<p>This feature allows a specific effect to run once when the light is turned on, before transitioning smoothly to the main effect.</p>"},{"location":"Configuration/#configuration","title":"Configuration","text":"<p>Link the optional intro entities in your <code>light</code> config:</p> <pre><code>    effects:\n      - addressable_cfx:\n          # ... other links ...\n          intro_effect: cfx_intro\n          intro_duration: cfx_intro_dur\n</code></pre>"},{"location":"Configuration/#options","title":"Options","text":"<ul> <li>None: Standard behavior (Main effect starts immediately).</li> <li>Wipe: A color wiper from start to end (Color 1).</li> <li>Fade: Fade in from black (Color 1).</li> <li>Center: A \"curtain\" open effect (Wipe from center to edges).</li> <li>Glitter: Sparkles appearing and fading out.</li> </ul>"},{"location":"Configuration/#transition-behavior","title":"Transition Behavior","text":"<p>When the Intro Duration ends, the Intro Effect will Dissolve (Soft Fairy Dust) into the Main Effect over 1.5 seconds. This creates a seamless, premium startup experience.</p>"},{"location":"Configuration/#advanced-multiple-strips","title":"Advanced: Multiple Strips","text":"<p>If you have two strips (e.g., <code>roof_lights</code> and <code>desk_lights</code>), just create two sets of controls (e.g., <code>roof_speed</code>, <code>desk_speed</code>) and link them to their respective effect entries in the <code>light</code> configuration.</p>"},{"location":"Configuration/#alternative-arduino-framework","title":"Alternative: Arduino Framework","text":"<p>While ESP-IDF is the standard for high performance, we also fully support the Arduino framework. It is particularly robust for timing stability via NeoPixelBus:</p> <pre><code>esp32:\n  board: esp32-s3-devkitc-1  # Or your board\n  framework:\n    type: arduino\n</code></pre> <p>[!TIP] The Arduino framework provides more stable NeoPixelBus timing, which is critical for smooth WLED effects. ESP-IDF is still supported but may exhibit slightly higher latency on complex effects.</p> <p>This is particularly important when: - Running multiple LED strips simultaneously - Using effects with high per-pixel math (Pacifica, Aurora, Plasma) - Targeting 40+ FPS on strips with 200+ LEDs</p>"},{"location":"Effect-Library/","title":"Available Effects &amp; Palettes","text":"<p>This library lists the high-fidelity effects currently optimized for ChimeraFX.</p>"},{"location":"Effect-Library/#palettes","title":"\ud83c\udfa8 Palettes","text":"<p>You can assign any of these palettes to compatible effects using the <code>palette</code> selector.</p> ID Palette Name Description 0 Default Uses the effect's hardcoded colors. 1 Aurora Northern lights colors. 2 Forest Earth greens, browns, and mossy tones. 3 Halloween Orange and purple mix. 4 Rainbow Full HSV spectrum cycle. 5 Fire Intense reds, oranges, and yellows. 6 Sunset Purple, red, orange, and yellow gradients. 7 Ice Cool whites, blues, and cyans. 8 Party Vibrant high-contrast mixed colors. 9 Lava Dark blacks, reds, and molten oranges. 10 Pastel Soft, desaturated soothing colors. 11 Ocean Deep blues, cyans, and white crests. 12 HeatColors Traditional heatmap colors. 13 Sakura Pink and white cherry blossom tones. 14 Rivendell Fantasy forest greens and blues. 15 Cyberpunk Neon pink, blue, and purple. 16 OrangeTeal Modern cinematic contrast. 17 Christmas Red and green holiday mix. 18 RedBlue Simple red and blue gradient. 19 Matrix Digital rain greens. 20 SunnyGold Bright gold and yellow. 21 Solid Solid color (uses primary color). 22 Fairy Magical pinks and purples. 23 Twilight Dusk blues and purples."},{"location":"Effect-Library/#effect-library","title":"\ud83d\udd25 Effect Library","text":""},{"location":"Effect-Library/#effect-list","title":"Effect List","text":"ID Name Description Controls Palette? Author 0 Static Solid color with palette support. Palette: Gradient/Solid Yes - 2 Breathe Apple-style standby breathing LED. Speed: Breathe rate Yes - 3 Wipe Primary/Secondary color wipe. Speed: Wipe speed Yes - 6 Sweep Ping-pong wipe animation. Speed: Sweep speed Yes - 8 Colorloop Solid color cycling through palette. Intensity: SaturationSpeed: Cycle speed No Harm Aldick 9 Rainbow Per-pixel rainbow with density control. Intensity: Zoom/DensitySpeed: Flow speed No Harm Aldick 18 Dissolve Random pixel color transitions. Speed: Dissolve rate No - 38 Aurora Northern lights animation. Intensity: Wave widthSpeed: Drift speed Yes Aircoookie 53 Fire Dual Two flames meeting in the center. Intensity: Sparking rateSpeed: Cooling rate Yes Mark Kriegsman (Adapt.) 63 Colorwaves Rainbow flag with breathing motion. Intensity: SaturationSpeed: Wave speed No WLED (Pride 2015) 64 Juggle Eight bouncing dots with trails. Intensity: TrailSpeed: Speed No Mark Kriegsman (FastLED) 66 Fire Realistic fire simulation. Intensity: Sparking rateSpeed: Cooling rate Yes Mark Kriegsman 74 Colortwinkles Magical fairy-dust twinkles. Intensity: Spawn rateSpeed: Fade speed Yes Mark Kriegsman 76 Meteor Meteor with random decay trail. Intensity: Trail lengthSpeed: Fall speed Yes - 91 Bouncing Balls Real gravity physics. Intensity: CountSpeed: Gravity Yes - 97 Plasma Smooth plasma animation. Intensity: FrequencySpeed: Morph speed Yes Jeremy Williams 101 Ocean Gentle ocean waves (Pacifica). Intensity: Zoom/ScaleSpeed: Ripple speed No Mark Kriegsman 104 Sunrise Gradual sunrise/sunset simulation. Speed: Duration No - 105 Phased Sine wave interference pattern. Intensity: CountSpeed: Speed Yes - 110 Flow Smooth color zones animation. Intensity: Zone countSpeed: Flow speed Yes - <p>(Note: More effects from the standard WLED library are being ported incrementally.)</p>"},{"location":"Installation/","title":"Installation &amp; Setup","text":"<p>Retrieving the code and getting it running on your ESP32.</p>"},{"location":"Installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Supported Hardware:<ul> <li>ESP32 (Classic): Fully supported.</li> <li>ESP32-S3: Fully supported (and recommended for new builds).</li> <li>ESP32-C3: NOT RECOMMENDED. The C3 is single-core, and since WLED effects are computationally intensive, running them alongside WiFi on a single core can cause stuttering and stability issues.</li> </ul> </li> <li>Frameworks (both supported):<ul> <li>Arduino (with NeoPixelBus) \u2014 simpler setup</li> <li>ESP-IDF (with esp32_rmt_led_strip) \u2014 slightly better performance</li> </ul> </li> </ul>"},{"location":"Installation/#method-1-external-component-recommended","title":"Method 1: External Component (Recommended)","text":"<p>This is the easiest way. ESPHome will download the component directly from GitHub when you compile.</p> <p>Add this to your <code>esphome.yaml</code>:</p> <pre><code>external_components:\n  - source: github://effelle/ChimeraFX@main\n    components: [cfx_effect]\n    refresh: always # \u26a0\ufe0f See \"Versioning &amp; Stability\" below\n\ncfx_effect: # Mandatory! Loads the component\n</code></pre>"},{"location":"Installation/#framework-specific-light-configuration","title":"Framework-Specific Light Configuration","text":""},{"location":"Installation/#option-a-arduino-neopixelbus-simpler","title":"Option A: Arduino + NeoPixelBus (Simpler)","text":"<pre><code>esp32:\n  board: your_board_here\n  framework:\n    type: arduino\n\nlight:\n  - platform: neopixelbus\n    type: GRB\n    variant: WS2812X\n    pin: GPIO16\n    num_leds: 60\n    name: \"LED Strip\"\n    effects:\n      - addressable_cfx:\n          name: \"Pacifica\"\n          effect_id: 101\n</code></pre>"},{"location":"Installation/#option-b-esp-idf-rmt-strip-better-performance","title":"Option B: ESP-IDF + RMT Strip (Better Performance)","text":"<pre><code>esp32:\n  board: your_board_here\n  framework:\n    type: esp-idf\n\nlight:\n  - platform: esp32_rmt_led_strip\n    rgb_order: GRB\n    pin: GPIO16\n    num_leds: 60\n    chipset: ws2812\n    max_refresh_rate: 24ms  # Recommended for clean timing\n    name: \"LED Strip\"\n    effects:\n      - addressable_cfx:\n          name: \"Pacifica\"\n          effect_id: 101\n</code></pre> <p>[!TIP] ESP-IDF typically provides 5-10% better FPS on longer strips (200+ LEDs).</p>"},{"location":"Installation/#versioning-stability","title":"\u26a0\ufe0f Versioning &amp; Stability","text":"<p>About <code>refresh: always</code></p> <p>Setting to <code>always</code> forces ESPHome to download the absolute latest version of the code every time you compile. </p> <ul> <li>Pros: You always get the newest features and bug fixes immediately.</li> <li>Cons: If I break something in the <code>main</code> branch, your build might break too!</li> </ul> <p>For Production Stability: Once you have a working setup, it is safer to remove <code>refresh: always</code> or pin to a specific commit hash. This ensures your lights keep working even if the repository changes.</p>"},{"location":"Installation/#method-2-manual-copy-advanced","title":"Method 2: Manual Copy (Advanced)","text":"<p>If you are developing or need to modify the code locally:</p> <ol> <li>Download the <code>components/</code> folder from the repository.</li> <li>Place it in your ESPHome config directory (e.g., <code>config/components/cfx_effect</code>).</li> <li>Point your configuration to the local folder:</li> </ol> <pre><code>external_components:\n  - source: components\n    components: [cfx_effect]\n</code></pre> <p>Note: This method requires you to manually update files when I release improvements or new effects.</p>"},{"location":"Installation/#dependencies","title":"Dependencies","text":"<p>The component handles its own dependencies automatically: - Arduino: Uses NeoPixelBus (auto-included) - ESP-IDF: Uses native RMT driver (built-in)</p> <p>You don't need to install anything else manually.</p>"},{"location":"Troubleshooting/","title":"Performance &amp; Troubleshooting","text":""},{"location":"Troubleshooting/#common-issues","title":"Common Issues","text":""},{"location":"Troubleshooting/#my-strip-freezes-or-blinks-random-colors","title":"\"My strip freezes or blinks random colors\"","text":"<p>This is almost always a power or memory/timing issue. *   Check Ground: Ensure your LED strip ground is connected to the ESP32 ground. *   RMT Buffer: See \"RMT Symbols\" below. *   PSRAM: If you are using an ESP32-S3 with PSRAM, verify <code>use_psram: false</code> is set in your light config. RMT does not play well with PSRAM latency.</p>"},{"location":"Troubleshooting/#the-effect-is-too-fast","title":"\"The effect is too fast\"","text":"<p>ESPHome runs at 60FPS, while WLED targets 42FPS. I have manually tuned most effects, but if one feels \"rushed,\" try lowering the Speed slider.</p>"},{"location":"Troubleshooting/#colors-look-wrong-red-is-green","title":"\"Colors look wrong (Red is Green)\"","text":"<p>Check your <code>rgb_order</code> in the YAML. *   WS2812B usually uses <code>GRB</code>. *   WS2811 usually uses <code>RGB</code>.</p>"},{"location":"Troubleshooting/#performance-tuning-esp-idf","title":"Performance Tuning (ESP-IDF)","text":""},{"location":"Troubleshooting/#rmt-symbols","title":"RMT Symbols","text":"<p>The ESP32 uses RMT (Remote Control) channels to drive LEDs. Each \"symbol\" represents a bit of data. Limited memory means you can't buffer infinite URLs.</p> Chip Max rmt_symbols Classic ESP32 512 (Total shared) ESP32-S3 192 (Per channel) <p>If you have flickering, try adjusting <code>rmt_symbols</code>. *   Usage: <code>light: ... rmt_symbols: 512</code></p>"},{"location":"Troubleshooting/#wifi-latency","title":"WiFi Latency","text":"<p>This component runs on Core 1 of the ESP32, while WiFi runs on Core 0. *   Good News: WiFi activity should NOT cause visible stuttering in effects. *   Bad News: Heavy OTA updates or web server usage might steal some bus time.</p>"},{"location":"Troubleshooting/#logging-diagnostics","title":"Logging &amp; Diagnostics","text":"<p>The component includes multiple diagnostic logs for troubleshooting. Enable them selectively:</p> <pre><code>logger:\n  level: DEBUG\n  logs:\n    wled_perf: DEBUG    # FPS, frame timing, heap usage (1/sec per strip)\n    wled_timing: DEBUG  # apply() call intervals, render time, skips\n    wled_effect: INFO   # Effect start/stop messages\n</code></pre> <p>Log Output Examples:</p> <pre><code>[D][wled_perf]: FPS:55 Frame_ms(min/mean/max):18/18/20 Heap:195656\n[D][wled_timing]: apply() interval:16574us render:1156us total:1160us skips:30\n</code></pre> Metric Healthy Value Issue if... FPS 50-60 &lt;40 = CPU overload render &lt;2000us &gt;3000us = effect too heavy skips 30 &gt;100 = timing issues Heap stable dropping = memory leak <p>[!WARNING] <code>wled_timing</code> is verbose (30+ lines/sec). Only enable when debugging performance.</p>"},{"location":"Troubleshooting/#additional-heap-monitoring-optional","title":"Additional Heap Monitoring (Optional)","text":"<p>For more detailed heap tracking, add this interval:</p> <pre><code>interval:\n  - interval: 2s\n    then:\n      - lambda: |-\n          ESP_LOGI(\"diag\", \"Heap: %u/%u | MaxBlock: %u\",\n            esp_get_free_internal_heap_size(),\n            esp_get_free_heap_size(),\n            heap_caps_get_largest_free_block(MALLOC_CAP_8BIT));\n</code></pre>"}]}